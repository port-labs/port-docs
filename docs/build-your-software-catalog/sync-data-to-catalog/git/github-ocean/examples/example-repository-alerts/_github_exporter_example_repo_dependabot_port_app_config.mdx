import Tabs from "@theme/Tabs"
import TabItem from "@theme/TabItem"

<details>

<summary><b>Port port-app-config.yml (click to expand)</b></summary>

```yaml showLineNumbers
resources:
  - kind: repository
    selector:
      query: "true"
    port:
      entity:
        mappings:
          identifier: .name
          title: .name
          blueprint: '"githubRepository"'
          properties:
            readme: file://README.md
            url: .html_url
            defaultBranch: .default_branch
  - kind: dependabot-alert
    selector:
      query: "true"
      states: ["open", "fixed"] # other options: auto_fixed, dismissed
    port:
      entity:
        mappings:
          identifier: .__repository + "/" + (.number | tostring)
          title: .number | tostring
          blueprint: '"githubDependabotAlert"'
          properties:
            state: .state
            severity: .security_advisory.severity
            packageName: .dependency.package.name
            packageEcosystem: .dependency.package.ecosystem
            manifestPath: .dependency.manifest_path
            scope: .dependency.scope
            ghsaID: .security_advisory.ghsa_id
            cveID: .security_advisory.cve_id
            url: .html_url
            references: "[.security_advisory.references[].url]"
            alertCreatedAt: .created_at
            alertUpdatedAt: .updated_at
          relations:
            repository: .__repository
  - kind: code-scanning-alerts
    selector:
      query: "true"
      state: "dismissed" # other options: open, closed, fixed
    port:
      entity:
        mappings:
          identifier: .__repository + "/" + (.number | tostring)
          title: .rule.name
          blueprint: '"githubCodeScanAlert"'
          properties:
            state: .state
            severity: .rule.severity
            tags: .rule.tags
            description: .rule.description
            url: .html_url
          relations:
            repository: .__repository

  - kind: secret-scanning-alerts
    selector:
      query: 'true'
      state: all
      hideSecret: false
    port:
      entity:
        mappings:
          identifier: .__repository + "/" + (.number | tostring)
          title: .number | tostring
          blueprint: '"githubSecretScanAlert"'
          properties:
            state: .state
            secret_type: .rule.secret_type
            url: .url
          relations:
            repository: .__repository
```

</details>

<Tabs groupId="config" queryString="parameter">

<TabItem label="Dependabot severity" value="dependabotSeverity">

You can use the `severity` selector to filter dependabot alerts by severity levels.  
An alert is ingested if its severity is **any one** of the severities you set (OR logic across the list). Valid values: `low`, `medium`, `high`, `critical`.

```yaml showLineNumbers
- kind: dependabot-alert
  selector:
    query: "true"
    states: ["open", "fixed"]
    # highlight-next-line
    severity: ["high", "critical"]
```

</TabItem>

<TabItem label="Dependabot ecosystems" value="dependabotEcosystems">

You can use the `ecosystems` selector to filter dependabot alerts by package ecosystems.  
An alert is ingested if its ecosystem is **any one** of the ecosystems you set (OR logic across the list). Valid values: `composer`, `go`, `maven`, `npm`, `nuget`, `pip`, `pub`, `rubygems`, `rust`.

```yaml showLineNumbers
- kind: dependabot-alert
  selector:
    query: "true"
    states: ["open", "fixed"]
    # highlight-next-line
    ecosystems: ["npm", "pip"]
```

</TabItem>

<TabItem label="Code scanning severity" value="codeScanningSeverity">

You can use the `severity` selector to filter code scanning alerts by severity level.  
An alert is ingested only if its severity matches the value you set. Valid values: `critical`, `high`, `medium`, `low`, `warning`, `note`, `error`.

```yaml showLineNumbers
- kind: code-scanning-alerts
  selector:
    query: "true"
    state: "open"
    # highlight-next-line
    severity: "high"
```

</TabItem>

</Tabs>
