# Report a bug - Jira example

## Overview
An example of creating a Jira bug from Port using Port's self service actions.

## Prerequisites
* [Jira API token](https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account/) with permissions to create new issues
* [Port's GitHub app](https://github.com/apps/getport-io) installed

## Quickstart - Create a Jira issue from Port

1. Create the following GitHub action secrets
* JIRA_API_TOKEN - [Jira API token](https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account) generated by the user
* JIRA_BASE_URL - The URL of your Jira organization
* JIRA_USER_EMAIL - The email of the Jira user that owns the Jira API token
* PORT_AUTH0_CLIENT_ID - Your port [client id]([How to get the credentials](https://docs.getport.io/build-your-software-catalog/sync-data-to-catalog/api/#find-your-port-credentials)) 
* PORT_AUTH0_CLIENT_SECRET - Your port [client secret]([How to get the credentials](https://docs.getport.io/build-your-software-catalog/sync-data-to-catalog/api/#find-your-port-credentials))

2. Install the Ports GitHub app from [here](https://github.com/apps/getport-io/installations/new).

3. Optional - Install Port's Jira integration [learn more](https://docs.getport.io/build-your-software-catalog/sync-data-to-catalog/project-management/jira#installation)

:::note Blueprint

This step is not required for this example, but it will create all the blueprint boilerplate for you, and also update the catalog in real time with the new issue created.

:::

4. Creating the action in Port
:::tip Action usage

You can add this action to the `Service` or `Jira Issue` blueprints

:::

<details>
<summary><b>Report a bug (Click to expand)</b></summary>

```json showLineNumbers
[
  {
    "identifier": "report_a_bug",
    "title": "Report a bug",
    "icon": "Jira",
    "userInputs": {
      "properties": {
        "description": {
          "icon": "DefaultProperty",
          "title": "Description",
          "type": "string"
        },
        "short_title": {
          "icon": "DefaultProperty",
          "title": "Short title",
          "type": "string"
        }
      },
      "required": [
        "short_title",
        "description"
      ],
      "order": [
        "short_title",
        "description"
      ]
    },
    "invocationMethod": {
      "type": "GITHUB",
      "omitPayload": false,
      "omitUserInputs": false,
      "reportWorkflowStatus": true,
      "repo": "<Enter GitHub repository>",
      "org": "<Enter GitHub organization>",
      "workflow": "jira.yml"
    },
    "trigger": "CREATE",
    "description": "Report a bug in Port to our product team.",
    "requiredApproval": false
  }
]
```

</details>

5. Create a workflow file under `.github/workflows/report-a-bug.yaml` using the workflow:

<details>
<summary><b>Report a bug workflow (Click to expand)</b></summary>

```json showLineNumbers
## This Workflow creates a basic jira bug and updates in Port
## Remove comments and edit for more fields as part of the jira bug

name: Report a bug in jira

on:
  workflow_dispatch:
    inputs:
      description:
        required: true
        type: string
      short_title:
        required: true
        type: string
#     priority:
#       required: true
#       type: string
#     custom_12345:
#     required: false
#     type: string
      port_payload:
        required: true
        type: string

jobs:
  create_jira_issue:
    runs-on: ubuntu-latest
    steps:
    - name: Login
      uses: atlassian/gajira-login@v3
      env:
        JIRA_BASE_URL: ${{ secrets.JIRA_BASE_URL }}
        JIRA_USER_EMAIL: ${{ secrets.JIRA_USER_EMAIL }}
        JIRA_API_TOKEN: ${{ secrets.JIRA_API_TOKEN }}

    - name: Inform starting of jira issue creation
      uses: port-labs/port-github-action@v1
      with:
        clientId: ${{ secrets.PORT_AUTH0_CLIENT_ID }}
        clientSecret: ${{ secrets.PORT_AUTH0_CLIENT_SECRET }}
        operation: PATCH_RUN
        runId: ${{ fromJson(inputs.port_payload).context.runId }}
        logMessage: |
            Creating a new Jira issue.. ‚õ¥Ô∏è

    - name: Create Jira issue
      id: create
      uses: atlassian/gajira-create@v3
      with:
        project: ENTER_JIRA_PROJECT_NAME
        issuetype: Bug
        summary:  Bug | ${{github.event.inputs.short_title}}
        description: |
          ${{github.event.inputs.description}}

        # Custom fields example
        # fields: '{"priority": {"name": "${{inputs.priority}}"}, "custom_12345": "label label"}'


    - name: Inform creation of Jira issue
      uses: port-labs/port-github-action@v1
      with:
        clientId: ${{ secrets.PORT_AUTH0_CLIENT_ID }}
        clientSecret: ${{ secrets.PORT_AUTH0_CLIENT_SECRET }}
        operation: PATCH_RUN
        link: https://getport.atlassian.net/browse/${{ steps.create.outputs.issue }}
        runId: ${{ fromJson(inputs.port_payload).context.runId }}
        logMessage: |
           Jira issue created! ‚úÖ
           The issue id is: ${{ steps.create.outputs.issue }}
```

</details>

6. Trigger the action from Port's [Self Service hub](https://app.getport.io/self-serve)

7. Done! wait for the bug to be created in Jira

Congrats üéâ You've created your first bug in Jira from Port!